# **ì‹¤ìŠµ 4: ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì—ì„œ ìƒˆë‚´ê¸° ì‹œê°„í‘œ ìƒì„±í•˜ê¸°**  

ì´ ì‹¤ìŠµì—ì„œëŠ” **Google Sheetsì—ì„œ íŠ¹ì • ì¹¼ëŸ¼ì´ ì²´í¬ë˜ë©´ Google Calendarì— ìë™ìœ¼ë¡œ ìˆ˜ì—… ì¼ì •ì„ ì¶”ê°€í•˜ëŠ” ì‹œìŠ¤í…œ**ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.  
ë˜í•œ, ì¶”ê°€ ì‹¤ìŠµìœ¼ë¡œ **ì´ë²¤íŠ¸ ìƒì„± ì‹œ Slackìœ¼ë¡œ ì•ˆë‚´ ë©”ì‹œì§€ë¥¼ ë°œì†¡í•˜ëŠ” ê¸°ëŠ¥**ë„ êµ¬í˜„í•©ë‹ˆë‹¤.  

---

# **1. Google Sheets ì„¤ì •**  

## **ğŸ“Œ 1-1. ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ìƒì„±**  
1. [Google Sheets](https://docs.google.com/spreadsheets/)ì—ì„œ **ìƒˆë¡œìš´ ìŠ¤í”„ë ˆë“œì‹œíŠ¸**ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.  
2. ì²« ë²ˆì§¸ í–‰ì— ë‹¤ìŒ **í—¤ë”**ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤:  
   - `Aì—´`: êµê³¼ëª© ì´ë¦„  
   - `Bì—´`: êµìˆ˜ë‹˜ ì´ë¦„  
   - `Cì—´`: êµìˆ˜ë‹˜ ì´ë©”ì¼  
   - `Dì—´`: ë³¸ì¸ íœ´ëŒ€í° ë²ˆí˜¸  
   - `Eì—´`: ì¹œêµ¬1 (ì´ë¦„ & ì´ë©”ì¼)  
   - `Fì—´`: ì¹œêµ¬2 (ì´ë¦„ & ì´ë©”ì¼)  
   - `Gì—´`: ì¹œêµ¬3 (ì´ë¦„ & ì´ë©”ì¼)  
   - `Hì—´`: ì¹œêµ¬4 (ì´ë¦„ & ì´ë©”ì¼)  
   - `Iì—´`: ìˆ˜ì—… ì‹œì‘ ì‹œê°„ (YYYY-MM-DD HH:MM)  
   - `Jì—´`: ìˆ˜ì—… ì¢…ë£Œ ì‹œê°„ (YYYY-MM-DD HH:MM)  
   - `Kì—´`: ê°•ì˜ì‹¤  
   - `Lì—´`: ì¼ì • ìƒì„± (ì²´í¬ë°•ìŠ¤ ì¶”ê°€)  

## **ğŸ“Œ 1-2. ì²´í¬ë°•ìŠ¤ ì¶”ê°€**  
1. **`Lì—´(ì¼ì • ìƒì„±)`**ì„ ì„ íƒí•©ë‹ˆë‹¤.  
2. **ìƒë‹¨ ë©”ë‰´ â†’ ì‚½ì… â†’ ì²´í¬ë°•ìŠ¤**ë¥¼ í´ë¦­í•˜ì—¬ **ì²´í¬ë°•ìŠ¤ ì¶”ê°€**  

---

# **2. Google Apps Script ì‘ì„±**  

## **ğŸ“Œ 2-1. Apps Script í¸ì§‘ê¸° ì—´ê¸°**  
1. **ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ìƒë‹¨ ë©”ë‰´**ì—ì„œ **í™•ì¥ í”„ë¡œê·¸ë¨ â†’ Apps Script**ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.  

## **ğŸ“Œ 2-2. Google Calendar ì¼ì • ì¶”ê°€ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**  
ì•„ë˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë³µì‚¬í•˜ì—¬ ì…ë ¥í•©ë‹ˆë‹¤:  

```javascript
// Google Calendar ID ì„¤ì • (ê¸°ë³¸ ìº˜ë¦°ë” ì‚¬ìš© ì‹œ 'primary' ì…ë ¥)
const CALENDAR_ID = 'primary'; 
const SLACK_WEBHOOK_URL = "YOUR_SLACK_WEBHOOK_URL";  // Slack ì•Œë¦¼ì„ ë³´ë‚¼ Webhook URL

function onEdit(e) {
  const sheet = e.source.getActiveSheet();
  const range = e.range;
  const column = range.getColumn();
  const row = range.getRow();
  const generateColumn = 12; // Lì—´(ì¼ì • ìƒì„±) ì²´í¬ë°•ìŠ¤ ìœ„ì¹˜

  // ì²´í¬ë°•ìŠ¤ê°€ í´ë¦­ë˜ì—ˆì„ ë•Œ ì‹¤í–‰
  if (column === generateColumn && range.getValue() === true) {
    createCalendarEvent(row);
  }
}

function createCalendarEvent(row) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const subject = sheet.getRange(row, 1).getValue();
  const professor = sheet.getRange(row, 2).getValue();
  const professorEmail = sheet.getRange(row, 3).getValue();
  const phoneNumber = sheet.getRange(row, 4).getValue();
  const friends = [
    sheet.getRange(row, 5).getValue(),
    sheet.getRange(row, 6).getValue(),
    sheet.getRange(row, 7).getValue(),
    sheet.getRange(row, 8).getValue()
  ].filter(friend => friend); // ë¹ˆ ì¹¸ ì œì™¸
  const startTime = new Date(sheet.getRange(row, 9).getValue());
  const endTime = new Date(sheet.getRange(row, 10).getValue());
  const location = sheet.getRange(row, 11).getValue();

  // Google Calendar ì´ë²¤íŠ¸ ìƒì„±
  const calendar = CalendarApp.getCalendarById(CALENDAR_ID);
  const event = calendar.createEvent(
    subject,
    startTime,
    endTime,
    {
      location: location,
      description: `êµìˆ˜ë‹˜: ${professor} (${professorEmail})\në³¸ì¸ ì—°ë½ì²˜: ${phoneNumber}\ní•¨ê»˜ ë“£ëŠ” ì¹œêµ¬: ${friends.join(', ')}`
    }
  );

  // Google Calendar ì´ë²¤íŠ¸ ë§í¬ ê°€ì ¸ì˜¤ê¸°
  const eventUrl = event.getId();
  sheet.getRange(row, 13).setValue(`https://calendar.google.com/calendar/r/eventedit/${eventUrl}`); // Mì—´ì— ë§í¬ ì €ì¥

  // Slack ì•Œë¦¼ ì „ì†¡
  sendSlackNotification(subject, startTime, endTime, location, eventUrl);
}

function sendSlackNotification(subject, startTime, endTime, location, eventUrl) {
  const message = {
    text: `ğŸ“¢ *ìƒˆë¡œìš´ ìˆ˜ì—… ì¼ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!* ğŸ‰\n\nğŸ“š *ê³¼ëª©:* ${subject}\nğŸ“… *ì‹œê°„:* ${startTime.toLocaleString()} ~ ${endTime.toLocaleString()}\nğŸ“ *ì¥ì†Œ:* ${location}\nğŸ”— *ì¼ì • í™•ì¸:* <${eventUrl}|ì—¬ê¸° í´ë¦­>`
  };

  const options = {
    method: "post",
    contentType: "application/json",
    payload: JSON.stringify(message)
  };

  UrlFetchApp.fetch(SLACK_WEBHOOK_URL, options);
}
```

---

# **3. íŠ¸ë¦¬ê±° ì„¤ì •**  
## **ğŸ“Œ 3-1. íŠ¸ë¦¬ê±° ì¶”ê°€í•˜ê¸°**  
1. **Apps Script í¸ì§‘ê¸°ì—ì„œ ì™¼ìª½ ì‹œê³„ ì•„ì´ì½˜(íŠ¸ë¦¬ê±°)**ì„ í´ë¦­  
2. **"íŠ¸ë¦¬ê±° ì¶”ê°€"** ë²„íŠ¼ í´ë¦­  
3. **ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •:**  
   - **í•¨ìˆ˜ ì„ íƒ**: `onEdit`  
   - **ì´ë²¤íŠ¸ ì†ŒìŠ¤**: ìŠ¤í”„ë ˆë“œì‹œíŠ¸  
   - **ì´ë²¤íŠ¸ ìœ í˜•**: ìˆ˜ì • ì‹œ  

4. ì €ì¥ í›„ **íŠ¸ë¦¬ê±° í™œì„±í™”**  

---

# **4. í…ŒìŠ¤íŠ¸ ì‹¤í–‰**  

## **ğŸ“Œ 4-1. í…ŒìŠ¤íŠ¸ ë°ì´í„° ì…ë ¥**  
Google Sheetsì— ë‹¤ìŒê³¼ ê°™ì€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤:  

| êµê³¼ëª© | êµìˆ˜ë‹˜ | êµìˆ˜ë‹˜ ì´ë©”ì¼ | ë³¸ì¸ íœ´ëŒ€í° | ì¹œêµ¬1 | ì¹œêµ¬2 | ì¹œêµ¬3 | ì¹œêµ¬4 | ì‹œì‘ ì‹œê°„ | ì¢…ë£Œ ì‹œê°„ | ê°•ì˜ì‹¤ | ì¼ì • ìƒì„± |  
|------|------|-------------|-----------|------|------|------|------|----------|----------|------|------|  
| ì»´í“¨í„°ê³µí•™ | ì´ìŠ¹ê¸° | prof@example.com | 010-1234-5678 | ê¹€ì² ìˆ˜ (cs@example.com) | ë°•ì˜í¬ (yh@example.com) | | | 2025-03-01 09:00 | 2025-03-01 11:00 | 101í˜¸ | âœ… |  

## **ğŸ“Œ 4-2. ì²´í¬ë°•ìŠ¤ í´ë¦­**  
1. `Lì—´(ì¼ì • ìƒì„±)` ì²´í¬ë°•ìŠ¤ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.  
2. **ìë™ìœ¼ë¡œ Google Calendarì— ì´ë²¤íŠ¸ê°€ ìƒì„±ë˜ê³ , Slackì— ì•Œë¦¼ì´ ì „ì†¡ë©ë‹ˆë‹¤.**  
3. Google Sheetsì˜ `Mì—´`ì— **ìƒì„±ëœ ì¼ì • ë§í¬ê°€ ìë™ ì…ë ¥**ë©ë‹ˆë‹¤.  

---

# **âœ… ì‹¤ìŠµ ê²°ê³¼**  
- Google Sheetsì—ì„œ ì²´í¬ë°•ìŠ¤ë¥¼ í´ë¦­í•˜ë©´ **Google Calendarì— ìë™ìœ¼ë¡œ ì¼ì •ì´ ì¶”ê°€ë¨**  
- ìƒì„±ëœ ì¼ì •ì˜ **Google Calendar ë§í¬ê°€ ìë™ ì…ë ¥ë¨**  
- **Slackìœ¼ë¡œ ì¼ì • ìƒì„± ì•Œë¦¼ì´ ìë™ ì „ì†¡ë¨**  

---

# **ğŸ“Œ ì¶”ê°€ ì‹¤ìŠµ: Slack ì•Œë¦¼ì„ ë” ì§ê´€ì ìœ¼ë¡œ ë§Œë“¤ê¸°**  
Slack ë©”ì‹œì§€ë¥¼ ë” ê°•ì¡°í•˜ê³  ì‹¶ë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì´ **ì´ëª¨ì§€ì™€ ê°•ì¡° íƒœê·¸**ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:  

```javascript
function sendSlackNotification(subject, startTime, endTime, location, eventUrl) {
  const message = {
    text: `ğŸ“¢ *ìƒˆë¡œìš´ ìˆ˜ì—… ì¼ì •ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!* ğŸ‰\n\nğŸ“š *ê³¼ëª©:* ${subject}\nğŸ“… *ì‹œê°„:* ${startTime.toLocaleString()} ~ ${endTime.toLocaleString()}\nğŸ“ *ì¥ì†Œ:* ${location}\nğŸ”— *[ì¼ì • í™•ì¸í•˜ê¸°](<${eventUrl}>)`
  };

  const options = {
    method: "post",
    contentType: "application/json",
    payload: JSON.stringify(message)
  };

  UrlFetchApp.fetch(SLACK_WEBHOOK_URL, options);
}
```

---

# **ğŸš€ ë‹¤ìŒ ë‹¨ê³„**
ì´ì œ **Google Sheets ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ Google Calendarì— ìë™ìœ¼ë¡œ ì¼ì •ì´ ì¶”ê°€ë˜ëŠ” ì‹œìŠ¤í…œ**ì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!  
ì¶”ê°€ì ìœ¼ë¡œ **ì´ë©”ì¼ ì•Œë¦¼ ê¸°ëŠ¥**ì„ ì¶”ê°€í•˜ê±°ë‚˜, **Google Meet ë§í¬ë¥¼ ìë™ ìƒì„±**í•˜ëŠ” ê¸°ëŠ¥ë„ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
